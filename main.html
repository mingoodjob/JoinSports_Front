<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/main.css">
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <title>메인페이지</title>
</head>

<script>

    const backend_base_url = "http://127.0.0.1:4000"
    const frontend_base_url = "http://127.0.0.1:5500"

    async function Send(){  // async: 비동기 데이터 주고받기가 완료될때까지 기다린 후 다음 라인을 실행

        const comment_data = {
            text : document.getElementById("comment_text").value
        }

        const response = await fetch(`${backend_base_url}/comment`,{
            method:'POST',
            body:JSON.stringify(comment_data)
        })

        response_json = await response.json()
        
        if (response.status == 200){
            let name = response_json.message
            console.log(name)
        }else{
            alert(response.status)
        }
    }

    $(function () {
        $("#comment_text").keydown(function (key) {
            if (key.keyCode == 13) {
                comment()
            }
        });
    })


    function modal() {
        let modal = document.getElementById('modal_body')
        modal.style.display = "flex"
    }

    function comment() {
        let text = document.getElementById("comment_text")
        let comment_list = document.getElementById("comment_list")
        let name = ['건빵먹고싶다', '핫도그먹고싶다', '햄버거먹고싶다']
        let pr_photo = ['1.jpeg', '2.jpeg', '3.jpeg']
        let namepick = Math.floor(Math.random() * name.length);
        console.log(pr_photo[namepick])

        html = `<div class="modal_comment">
            <div class="comment_pr_photo"><img src="./img/${pr_photo[namepick]}"></div>
            <div class="comment_content_box">
                <div class="comment_content">
                    ${text.value}
                </div>
                <div class="comment_bottom_info">
                <div class="comment_nick">${name[namepick]}</div>
                <div class="comment_content_time">방금</div>
                <div class="comment_content_edit">수정</div>
                <div class="comment_content_delete">삭제</div>
                </div>
            </div>
        </div>`
        
        $('#comment_list').prepend(html)
        $('#comment_text').val(null)
    }
</script>

<body>
    <!-- modal box -->
    <div id="modal_body" class="modal_body">
        <div class="modal_box">
            <div class="modal_title">
                멤버 카드
            </div>
            <div class="modal_pr_info">
                <div class="pr_photo">
                    <img src="./img/1.jpeg">
                </div>
                <div class="pr_desc">
                    <div>
                        <div class="pr_desc_title">닉네임</div>
                        <div class="pr_desc_content">감자탕먹고싶다</div>
                    </div>
                    <div>
                        <div class="pr_desc_title">이메일</div>
                        <div class="pr_desc_content">gamjatang@naver.com</div>
                    </div>
                    <div>
                        <div class="pr_desc_title_tmi">
                            <div>Sport TMI</div>
                        </div>
                        <div class="pr_desc_content">
                            프로야구 SSG 주전 유격수 박성한(24)이 재치 있는 수비로 팀 승리를 이끈 다음 날에는 불방망이로 연승을 견인했다.
                        </div>
                    </div>
                </div>
            </div>

            <div id="comment_list" class="comment_content_box_list">

                <!-- 모달 코멘트 시작 -->
                <div class="modal_comment">
                    <div class="comment_pr_photo"><img src="./img/1.jpeg"></div>
                    <div class="comment_content_box">
                        <div class="comment_content">
                            안치홍을 상대로는 볼넷을 내주며 3회 이후 처음으로 누상에 주자를 내보냈다. 팔의 힘이 빠진 듯 했다.
                        </div>
                        <div class="comment_bottom_info">
                            <div class="comment_nick">라면먹고싶다</div>
                            <div class="comment_content_time">방금</div>
                            <div class="comment_content_edit">수정</div>
                            <div class="comment_content_delete">삭제</div>
                        </div>
                    </div>
                </div>
                <!-- 모달 코멘트 끝 -->

            </div>

            <!-- 댓글 입력창 시작 -->
            <div class="modal_comment_input">
                <div>
                    <textarea id="comment_text" placeholder="입력...."></textarea>
                </div>
                <button onclick="Send()" class="comment_button" type="button">전송</button>


            </div>
            <!-- 댓글 입력창 끝 -->

        </div>
    </div>


    <!-- main box -->
    <div class="slide">
        <img src="./img/slide2.jpeg">
    </div>
    <div class="main">
        <div class="category_menu">
            <img src="img/soccer.png">
            <img src="img/base.png">
            <img src="img/basket.png">
            <img src="img/valley.png">
        </div>
        <div class="member_card">
            <div onclick="modal()">
                <img src="./img/1.jpeg">
            </div>
            <div>
                <img src="./img/2.jpeg">
            </div>
            <div>
                <img src="./img/3.jpeg">
            </div>
            <div>
                <img src="./img/1.jpeg">
            </div>
            <div>
                <img src="./img/3.jpeg">
            </div>
            <div>
                <img src="./img/3.jpeg">
            </div>
            <div>
                <img src="./img/3.jpeg">
            </div>
            <div>
                <img src="./img/3.jpeg">
            </div>
            <div>
                <img src="./img/1.jpeg">
            </div>
        </div>
    </div>
</body>

</html>